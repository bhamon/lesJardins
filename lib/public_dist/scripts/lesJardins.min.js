"use strict";angular.module("lesJardins",["ui.router","ngResource","ngCookies","ngMessages","ngMaterial","hc.marked","freyja"]).constant("lesJardins-config",{templatesPath:"/templates",directivesPath:"/directives",apiPath:"/api",sessionCookie:"sessionToken"}).config(["$locationProvider","$urlRouterProvider","$stateProvider","$mdThemingProvider","lesJardins-config","freyja-sessionHandlerProvider",function(e,a,t,s,i,n){e.html5Mode(!0),a.otherwise("/articles"),t.state("logIn",{url:"/logIn",views:{header:{templateUrl:i.templatesPath+"/lesJardins-header.html"},main:{template:"<div></div>",controller:["$state","freyja-sessionHandler","$mdDialog","$scope",function(e,a,t,s){a.recover().then(function(){e.go("lesJardins.articles")})}]}}}).state("lesJardins",{"abstract":!0,resolve:{session:["$state","freyja-sessionHandler",function(e,a){a.init()["catch"](function(){e.go("logIn")})}]},views:{header:{templateUrl:i.templatesPath+"/lesJardins-header.html",controller:"lesJardins-header"},sidenav:{templateUrl:i.templatesPath+"/lesJardins-sidenav.html",controller:"lesJardins-sidenav"}}}).state("lesJardins.notifications",{url:"/notifications",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-notifications.html",controller:"lesJardins-notifications"}}}).state("lesJardins.articles",{url:"/articles",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-articles.html",controller:"lesJardins-articles"}}}).state("lesJardins.articles.create",{url:"/create",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-article-create.html",controller:"lesJardins-article-create"}}}).state("lesJardins.article",{"abstract":!0,url:"/article",resolve:{article:["lesJardins-api-article","lesJardins-api-user",function(e,a){return{id:"1234",date:new Date,author:{firstName:"John",lastName:"Doe"},title:"Test",text:"Text",comments:[{date:new Date,author:{firstName:"Jane",lastName:"Doe"},text:"Chouette nouvelle =D"},{date:new Date,author:{firstName:"John",lastName:"Doe"},text:"Non c'est **nul** :p"}]}}]}}).state("lesJardins.article.view",{url:"/view",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-article-view.html",controller:"lesJardins-article-view"}}}).state("lesJardins.article.edit",{url:"/edit",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-article-edit.html",controller:"lesJardins-article-edit"}}}).state("lesJardins.profile",{url:"/profile",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-profile.html",controller:"lesJardins-profile"}}}).state("lesJardins.contact",{url:"/contact",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-contact.html",controller:"lesJardins-contact"}}}).state("lesJardins.admin",{"abstract":!0,url:"/admin"}).state("lesJardins.admin.settings",{url:"/settings",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-settings.html",controller:"lesJardins-admin-settings"}}}).state("lesJardins.admin.users",{url:"/users",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-users.html",controller:"lesJardins-admin-users"}}}).state("lesJardins.admin.users.create",{url:"/new",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-user-create.html",controller:"lesJardins-admin-user-create"}}}).state("lesJardins.admin.user",{"abstract":!0,url:"/user/:id",resolve:{user:["lesJardins-api-user",function(e){return{id:"1234",email:"jane.doe@domain.com",firstName:"Jane",lastName:"Doe",apartment:{building:"A",number:32}}}]}}).state("lesJardins.admin.user.view",{url:"/view",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-user-view.html",controller:"lesJardins-admin-user-view"}}}).state("lesJardins.admin.user.edit",{url:"/edit",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-user-edit.html",controller:"lesJardins-admin-user-edit"}}}).state("lesJardins.help",{url:"/help",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-help.html"}}}).state("lesJardins.admin.buildings",{url:"/buildings",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-buildings.html",controller:"lesJardins-admin-buildings"}}}).state("lesJardins.admin.buildings.create",{url:"/new",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-building-create.html",controller:"lesJardins-admin-building-create"}}}).state("lesJardins.admin.building",{"abstract":!0,url:"/building/:id",resolve:{building:["lesJardins-api-lot",function(e){return{id:"1234",name:"A",apartments:[{id:"1234",number:1,floor:1,shares:{common:0,stairwell:0,elevator:0}}],serviceCharges:[{name:"EDF",value:2365.2}],doorCode:"2120",elevator:!0}}]}}).state("lesJardins.admin.building.view",{url:"/view",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-building-view.html",controller:"lesJardins-admin-building-view"}}}).state("lesJardins.admin.building.edit",{url:"/edit",views:{"main@":{templateUrl:i.templatesPath+"/lesJardins-admin-building-edit.html",controller:"lesJardins-admin-building-edit"}}}),s.theme("default").primaryPalette("blue-grey").accentPalette("orange").warnPalette("red"),s.theme("dark","default").primaryPalette("orange").accentPalette("purple").warnPalette("red").dark(),n.setCookieName(i.sessionCookie),n.attachSessionHook("populate",["lesJardins-config","lesJardins-api-session","lesJardins-api-user","freyja-sessionHandler",function(e,a,t,s){var i=s.getSession();i.data.user={id:"1234",email:"jane.doe@domain.com",firstName:"Jane",lastName:"Doe"}}]),n.attachSessionHook("recover",["$mdDialog",function(e){return e.show({templateUrl:i.templatesPath+"/lesJardins-logIn.html",controller:"lesJardins-logIn",escapeToClose:!1})}]),n.attachSessionHook("remove",["lesJardins-api-session",function(e){}])}]).run(["$rootScope",function(e){e.$on("$stateChangeError",function(e,a,t,s,i,n){console.log("$stateChangeError - fired when an error occurs during transition."),console.log(arguments)})}]),angular.module("lesJardins").factory("lesJardins-api-session",["lesJardins-config","freyja-api",function(e,a){return a.createResource(e.apiPath+"/sessions/:token",{},{get:{method:"GET",requiresAuth:!0},query:{method:"GET",requiresAuth:!0,isArray:!0,params:{page:"@page",size:"@size"}},create:{method:"POST"},remove:{method:"DELETE",requiresAuth:!0,member:!0,params:{token:"@token"}}})}]),angular.module("lesJardins").factory("lesJardins-api-user",["lesJardins-config","freyja-api",function(e,a){return a.createResource(e.apiPath+"/users/:id",{},{get:{method:"GET",requiresAuth:!0},query:{method:"GET",requiresAuth:!0,isArray:!0,params:{page:"@page",size:"@size"}}})}]),angular.module("lesJardins").factory("lesJardins-api-article",["lesJardins-config","freyja-api",function(e,a){return a.createResource(e.apiPath+"/articles/:id",{},{get:{method:"GET",requiresAuth:!0},query:{method:"GET",requiresAuth:!0,isArray:!0,params:{page:"@page",size:"@size"}}})}]),angular.module("lesJardins").factory("lesJardins-api-lot",["lesJardins-config","freyja-api",function(e,a){return a.createResource(e.apiPath+"/lot/:id",{},{get:{method:"GET",requiresAuth:!0},query:{method:"GET",requiresAuth:!0,isArray:!0,params:{page:"@page",size:"@size"}}})}]),angular.module("lesJardins").controller("lesJardins-logIn",["$scope","$mdDialog","lesJardins-api-session",function(e,a,t){e.data={email:"",password:"",remindMe:!1},e.logIn=function(){e.formLogIn.$invalid||a.hide({token:"123456",creationDate:new Date,rights:[],data:{},remindMe:e.data.remindMe})}}]),angular.module("lesJardins").controller("lesJardins-header",["$scope","$state","$mdSidenav","freyja-sessionHandler",function(e,a,t,s){e.notifications=[{id:"123",date:new Date,viewed:!1,type:"council.subscription",message:"Test"}],e.toggleSidenav=function(){t("sidenav").toggle()},e.logOut=function(){s.logOut()["finally"](function(){a.go("logIn")})},e.gotoNotifications=function(){a.go("lesJardins.notifications")},e.gotoHelp=function(){a.go("lesJardins.help")}}]),angular.module("lesJardins").controller("lesJardins-sidenav",["$scope","$state","freyja-sessionHandler",function(e,a,t){e.user=t.getSession().data.user,e.gotoDashboard=function(){a.go("lesJardins.dashboard")},e.gotoArticles=function(){a.go("lesJardins.articles")},e.gotoProfile=function(){a.go("lesJardins.profile")},e.gotoContact=function(){a.go("lesJardins.contact")},e.gotoAdminSettings=function(){a.go("lesJardins.admin.settings")},e.gotoAdminUsers=function(){a.go("lesJardins.admin.users")},e.gotoAdminBuildings=function(){a.go("lesJardins.admin.buildings")}}]),angular.module("lesJardins").controller("lesJardins-notifications",["$scope","$state",function(e,a){e.notifications=[{id:"123",date:new Date,viewed:!1,type:"council.subscription",message:"Test"},{id:"123",date:new Date,viewed:!1,type:"council.subscription",message:"Test"},{id:"123",date:new Date,viewed:!0,type:"council.subscription",message:"Test"}]}]),angular.module("lesJardins").controller("lesJardins-articles",["$scope","$state",function(e,a){e.articles=[{id:"1234",date:new Date(Date.now()-18e6),author:{firstName:"Jane",lastName:"Doe"},title:"Etat des lieux des différents travaux",text:"Ci-dessous l'avancement des travaux de réparation constatés lors de l'état des lieux :\n* Jardin : 20%\n* Escalier bâtiment A : 100%"},{id:"5678",date:new Date(Date.now()-1728e5),author:{firstName:"John",lastName:"Doe"},title:"Journées porte ouverte à la résidence",text:"Veuillez prendre note que le **08/08** aura lieu une journée porte ouverte dans notre résidence. A cette occasion, Expansiel passera dans chacun des logements afin de lever les réserves (marquées JPO)."},{id:"5678",date:new Date(Date.now()-1728e5),author:{firstName:"John",lastName:"Doe"},title:"Journées porte ouverte à la résidence",text:"Veuillez prendre note que le **08/08** aura lieu une journée porte ouverte dans notre résidence. A cette occasion, Expansiel passera dans chacun des logements afin de lever les réserves (marquées JPO)."},{id:"5678",date:new Date(Date.now()-1728e5),author:{firstName:"John",lastName:"Doe"},title:"Journées porte ouverte à la résidence",text:"Veuillez prendre note que le **08/08** aura lieu une journée porte ouverte dans notre résidence. A cette occasion, Expansiel passera dans chacun des logements afin de lever les réserves (marquées JPO)."},{id:"5678",date:new Date(Date.now()-1728e5),author:{firstName:"John",lastName:"Doe"},title:"Journées porte ouverte à la résidence",text:"Veuillez prendre note que le **08/08** aura lieu une journée porte ouverte dans notre résidence. A cette occasion, Expansiel passera dans chacun des logements afin de lever les réserves (marquées JPO)."}],e.view=function(e){a.go("lesJardins.article.view",{id:e.id})}}]),angular.module("lesJardins").controller("lesJardins-newsEntry-view",["$scope","$state","newsEntry",function(e,a,t){e.newsEntry=t,e.edit=function(){a.go("lesJardins.newsEntry.edit",{id:t.id})}}]),angular.module("lesJardins").controller("lesJardins-article-view",["$scope","$element","$state","$mdToast","freyja-sessionHandler","article",function(e,a,t,s,i,n){e.user=i.getSession().data.user,e.article=n,e.now=new Date,e.data={text:""},e.gotoBack=function(){t.go("lesJardins.articles")},e.edit=function(){t.go("lesJardins.article.edit",{id:n.id})},e.comment=function(){e.formComment.$valid&&s.show(s.simple().content("Commentaire ajouté.").position("top right").parent(a).hideDelay(3e3))}}]),angular.module("lesJardins").controller("lesJardins-article-edit",["$scope","$state","$element","$mdToast","freyja-sessionHandler","article",function(e,a,t,s,i,n){e.user=i.getSession().data.user,e.article=n,e.now=new Date,e.data={title:n.title,text:n.text},e.gotoBack=function(){a.go("lesJardins.article.view",{id:n.id})},e.save=function(a){e.formArticle.$valid&&s.show(s.simple().content("Modifications sauvegardées.").position("top right").parent(t).hideDelay(3e3))}}]),angular.module("lesJardins").controller("lesJardins-profile",["$scope","$element","$mdToast","freyja-sessionHandler",function(e,a,t,s){e.user=s.getSession().data.user,e.apartments=[{id:"1234",building:{name:"B"},number:12,floor:1,shares:{common:621,stairwell:325,elevator:65}},{id:"1234",building:{name:"A"},number:25,floor:2,shares:{common:475,stairwell:215,elevator:36}}],e.carParks=[{id:"1234",number:30,shares:18},{id:"1234",number:31,shares:19},{id:"1234",number:32,shares:14}],e.data={},e.data.identity={firstName:e.user.firstName,lastName:e.user.lastName,email:e.user.email},e.data.credentials={oldPassword:"",newPassword:""},e.data.lots={searchApartment:null,searchCarPark:null,carParks:[]},e.data.notifications={article:!1,councilReport:!1,email:!1},e.getLabel=function(e){return e.building.name+e.number},e.findApartment=function(a){return e.apartments},e.findCarParks=function(a){return e.carParks},e.save=function(){t.show(t.simple().content("Modifications sauvegardées.").position("top right").parent(a).hideDelay(3e3))}}]),angular.module("lesJardins").controller("lesJardins-contact",["$scope","$element","$mdToast",function(e,a,t){e.data={},e.data.object="",e.data.message="",e.send=function(){e.formContact.$valid&&t.show(t.simple().content("Message envoyé.").position("top right").parent(a).hideDelay(3e3))}}]),angular.module("lesJardins").controller("lesJardins-admin-settings",["$scope","$state","$element","$mdDialog","$mdToast","lesJardins-config",function(e,a,t,s,i,n){e.dataSource={type:"mongodb",user:"user",password:"password",host:"localhost",port:1234,resource:"lesJardins"},e.mailServer={type:"smtp",user:"user",password:"password",host:"localhost",port:1234};var r=function(){i.show(i.simple().content("Paramètre modifié.").position("top right").parent(t).hideDelay(3e3))};e.editDataSource=function(){return s.show({templateUrl:n.templatesPath+"/lesJardins-admin-setting-dataSource-edit.html",controller:"lesJardins-admin-setting-dataSource-edit",locals:{dataSource:e.dataSource}}).then(function(a){e.dataSource=a,r()})},e.editMailServer=function(){return s.show({templateUrl:n.templatesPath+"/lesJardins-admin-setting-mailServer-edit.html",controller:"lesJardins-admin-setting-mailServer-edit",locals:{mailServer:e.mailServer}}).then(function(a){e.mailServer=a,r()})}}]),angular.module("lesJardins").controller("lesJardins-admin-setting-dataSource-edit",["$scope","$mdDialog","lesJardins-config","dataSource",function(e,a,t,s){e.data={type:s.type,host:s.host,port:s.port,user:s.user,password:s.password,resource:s.resource},e.save=function(){e.formDataSource.$valid&&a.hide(e.data)},e.cancel=function(){a.cancel()}}]),angular.module("lesJardins").controller("lesJardins-admin-setting-mailServer-edit",["$scope","$mdDialog","lesJardins-config","mailServer",function(e,a,t,s){e.data={type:s.type,host:s.host,port:s.port,user:s.user,password:s.password},e.save=function(){e.formMailServer.$valid&&a.hide(e.data)},e.cancel=function(){a.cancel()}}]),angular.module("lesJardins").controller("lesJardins-admin-users",["$scope","$state","$element","$mdToast",function(e,a,t,s){e.users=[{id:"1a2b3c",firstName:"John",lastName:"Doe",email:"john.doe@edf.fr"},{id:"4d5e6f",firstName:"Jane",lastName:"Doe",email:"jane.doe@edf.fr"}],e.create=function(){a.go("lesJardins.admin.users.create")},e.view=function(e){a.go("lesJardins.admin.user.view",{id:"1234"})},e.remove=function(e){s.show(s.simple().content("Utilisateur supprimé !").position("top right").parent(t).hideDelay(3e3))}}]),angular.module("lesJardins").controller("lesJardins-admin-user-create",["$scope","$state","$element","$mdToast","lesJardins-config",function(e,a,t,s,i){e.templateInfo=i.templatesPath+"/lesJardins-admin-user-info.html",e.data={},e.data={login:"",password:"",firstName:"",lastName:"",email:""},e.gotoBack=function(e){a.go("lesJardins.admin.users")},e.save=function(){s.show(s.simple().content("Utilisateur créé !").position("top right").parent(t).hideDelay(3e3)),a.go("lesJardins.admin.user.edit",{id:"123456"})}}]),angular.module("lesJardins").controller("lesJardins-admin-user-view",["$scope","$state","user",function(e,a,t){e.user=t,e.gotoBack=function(e){a.go("lesJardins.admin.users")},e.edit=function(){a.go("lesJardins.admin.user.edit",{id:t.id})}}]),angular.module("lesJardins").controller("lesJardins-admin-user-edit",["$scope","$state","$element","$mdToast","lesJardins-config","user",function(e,a,t,s,i,n){e.user=n,e.templateInfo=i.templatesPath+"/lesJardins-admin-user-info.html",e.data={},e.data.user={firstName:n.firstName,lastName:n.lastName,email:n.email},e.gotoBack=function(){a.go("lesJardins.admin.user.view",{id:n.id})},e.save=function(a){e.formUser.$valid&&s.show(s.simple().content("Modifications sauvegardées !").position("top right").parent(t).hideDelay(3e3))}}]),angular.module("lesJardins").controller("lesJardins-admin-buildings",["$scope","$state","$element","$mdToast",function(e,a,t,s){e.buildings=[{id:"1a2b3c",name:"A",apartmentsCount:15},{id:"4d5e6f",name:"B",apartmentsCount:20}],e.create=function(){a.go("lesJardins.admin.buildings.create")},e.view=function(e){a.go("lesJardins.admin.building.view",{id:e.id})},e.remove=function(e){s.show(s.simple().content("Bâtiment supprimé.").position("top right").parent(t).hideDelay(3e3))}}]),angular.module("lesJardins").controller("lesJardins-admin-building-create",["$scope","$state","$element","$mdToast","lesJardins-config",function(e,a,t,s,i){e.templateInfo=i.templatesPath+"/lesJardins-admin-building-info.html",e.data={},e.data={name:""},e.gotoBack=function(e){a.go("lesJardins.admin.buildings")},e.save=function(){s.show(s.simple().content("Bâtiment créé.").position("top right").parent(t).hideDelay(3e3)),a.go("lesJardins.admin.user.edit",{id:"123456"})}}]),angular.module("lesJardins").controller("lesJardins-admin-building-view",["$scope","$state","building",function(e,a,t){e.building=t,e.gotoBack=function(e){a.go("lesJardins.admin.buildings")},e.edit=function(){a.go("lesJardins.admin.building.edit",{id:t.id})}}]),angular.module("lesJardins").controller("lesJardins-admin-building-edit",["$scope","$state","$element","$mdToast","lesJardins-config","building",function(e,a,t,s,i,n){e.building=n,e.templateInfo=i.templatesPath+"/lesJardins-admin-building-info.html",e.data={},e.data={},e.gotoBack=function(){a.go("lesJardins.admin.building.view",{id:n.id})},e.save=function(){e.formBuilding.$valid&&s.show(s.simple().content("Modifications sauvegardées.").position("top right").parent(t).hideDelay(3e3))}}]),angular.module("lesJardins").directive("lesJardinsAuthValidator",function(){return{require:"ngModel",link:function(e,a,t,s){s.$validators.auth=function(e,a){return!0}}}});